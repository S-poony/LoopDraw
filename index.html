<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawing Looper - Chrono Replay</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body class="flex flex-col h-screen">

    <!-- Interface -->
    <div class="p-4 bg-zinc-900 border-b border-zinc-800 flex items-center justify-between z-20">
        <div class="flex items-center gap-6">
            <div>
                <h1 class="font-bold text-xl text-white">Drawing Looper</h1>
                <p class="text-xs text-zinc-500">Cycle : <span id="cycleCount" class="text-blue-400">1</span> | Couleur
                    : <span id="currentColorBox" class="inline-block w-3 h-3 rounded-full align-middle"></span></p>
            </div>

            <div class="flex flex-col">
                <label class="text-[10px] uppercase text-zinc-500 font-bold">Durée du cycle</label>
                <div class="flex items-center gap-2">
                    <input type="range" id="durationSlider" min="5" max="60" value="30" class="w-24">
                    <span id="durationVal" class="text-sm font-mono">30s</span>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-4">
            <!-- Tools -->
            <div class="flex items-center gap-2 bg-zinc-800 rounded-lg p-1">
                <button id="penBtn"
                    class="tool-btn active bg-zinc-700 hover:bg-zinc-600 text-white px-3 py-1.5 rounded text-sm flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" />
                    </svg>
                    Pen
                </button>
                <button id="eraserBtn"
                    class="tool-btn bg-zinc-800 hover:bg-zinc-700 text-zinc-300 hover:text-white px-3 py-1.5 rounded text-sm flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21" />
                        <path d="M22 21H7" />
                        <path d="m5 11 9 9" />
                    </svg>
                    Eraser
                </button>
            </div>

            <!-- Onion Skin Toggle -->
            <button id="onionBtn"
                class="bg-zinc-800 hover:bg-zinc-700 text-zinc-300 hover:text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.61-.13-1.24-.2-1.36-.1z" />
                </svg>
                <span id="onionText">Onion Skin: Off</span>
            </button>

            <button id="clearBtn"
                class="bg-zinc-800 hover:bg-red-900 text-zinc-300 hover:text-white px-4 py-2 rounded-lg text-sm transition-colors">Tout
                effacer</button>
            <div class="flex flex-col items-end">
                <div class="w-48 h-3 bg-zinc-800 rounded-full overflow-hidden border border-zinc-700">
                    <div id="progressBar" class="h-full bg-blue-500 w-0 transition-all duration-100"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Zone de dessin -->
    <div class="relative flex-grow bg-white overflow-hidden">
        <!-- Onion skin: STATIC snapshot of all previous cycles (fully drawn) -->
        <canvas id="onionCanvas" class="absolute top-0 left-0 w-full h-full pointer-events-none"
            style="opacity: 0; transition: opacity 0.3s;"></canvas>
        <!-- Replay des cycles précédents (animated based on time) -->
        <canvas id="replayCanvas" class="absolute top-0 left-0 w-full h-full"></canvas>
        <!-- Dessin en cours -->
        <canvas id="activeCanvas" class="absolute top-0 left-0 w-full h-full"></canvas>
    </div>

    <script src="app.js"></script>
</body>

</html>